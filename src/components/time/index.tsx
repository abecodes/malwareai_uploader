import * as React from "react";
import { useState, useEffect } from "react";

import "./time.css";

interface IProps {
	requests: number;
	reset: number;
}

const _getTime = (reset: number) => {
	const d = new Date(reset - Date.now());
	return `${String(d.getMinutes()).padStart(2, "0")}:${String(
		d.getSeconds()
	).padStart(2, "0")}`;
};

export default ({ requests, reset }: IProps) => {
	const [timeleft, setTimeleft] = useState("");

	useEffect(() => {
		if (reset) {
			setTimeleft(_getTime(reset));
			const i = setInterval(() => {
				setTimeleft(_getTime(reset));
			}, 1000);

			return () => clearInterval(i);
		}
	}, [reset]);

	return (
		<p>
			{requests} request(s) left for the next {timeleft}
		</p>
	);
};
