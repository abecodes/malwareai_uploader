import * as React from "react";
import { useState, useEffect } from "react";
import { Table, Icon } from "rsuite";
import _getRating from "../../utils/_getRating";

import "./table.css";
import IconCell from "./_iconCell";

interface IProps {
	files: IFile[];
}

export default ({ files }: IProps) => {
	const [height, setHeight] = useState<number>(window.innerHeight - 56);

	const handleResize = (event: UIEvent) => setHeight(window.innerHeight - 56);

	useEffect(() => {
		window.addEventListener("resize", handleResize);

		return () => window.removeEventListener("resize", handleResize);
	}, []);

	return files.length ? (
		<Table
			height={height}
			data={files}
			rowHeight={52}
			rowClassName={(rowData) =>
				rowData && rowData.id !== undefined ? _getRating(rowData.result) : ""
			}
			virtualized
		>
			<Table.Column flexGrow={1} align="center">
				<Table.HeaderCell></Table.HeaderCell>
				<IconCell />
			</Table.Column>

			<Table.Column flexGrow={3} align="center">
				<Table.HeaderCell>Id</Table.HeaderCell>
				<Table.Cell dataKey="id" />
			</Table.Column>

			<Table.Column flexGrow={3}>
				<Table.HeaderCell>Path</Table.HeaderCell>
				<Table.Cell dataKey="path" />
			</Table.Column>

			<Table.Column flexGrow={2}>
				<Table.HeaderCell>Size (mb)</Table.HeaderCell>
				<Table.Cell dataKey="size" />
			</Table.Column>

			<Table.Column flexGrow={2}>
				<Table.HeaderCell>Malicious (%)</Table.HeaderCell>
				<Table.Cell dataKey="result" />
			</Table.Column>
		</Table>
	) : (
		<div className="empty-state">
			<Icon icon="file-upload" size="5x" />
			<p>No files uploaded so far</p>
		</div>
	);
};
