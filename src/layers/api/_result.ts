interface IResult {
	ID: string;
	MD5: string;
	SHA1: string;
	SHA256: string;
	SHA512: string;
	Filename: string;
	Size: number;
	FileType: string;
	Label: string;
	ScoreBenign: string;
	ScoreMalicious: string;
}

export default (apiKey: string, fileID: string): Promise<IResult> =>
	fetch(`https://www.malware.ai/api/analysis/${fileID}`, {
		method: "GET",
		headers: {
			Authorization: `Bearer ${apiKey}`,
		},
	}).then((res) => {
		if (res.status !== 200) {
			throw new Error("still pending");
		}

		return res.json();
	});
